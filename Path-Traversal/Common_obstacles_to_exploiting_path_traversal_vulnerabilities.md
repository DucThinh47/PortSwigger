# Common obstacles to exploiting path traversal vulnerabilities

Nhiều ứng dụng có cơ chế bảo vệ nhằm ngăn chặn các cuộc tấn công path traversal khi xử lý đầu vào của người dùng trong đường dẫn tệp. Tuy nhiên, những biện pháp này đôi khi có thể bị vượt qua.

Nếu ứng dụng loại bỏ hoặc chặn chuỗi path traversal (../) khỏi tên tệp do người dùng cung cấp, kẻ tấn công vẫn có thể tìm cách lách qua bằng nhiều kỹ thuật khác nhau.

Một trong những cách phổ biến là sử dụng đường dẫn tuyệt đối từ thư mục gốc của hệ thống, chẳng hạn như:

    filename=/etc/passwd

Với cách này, kẻ tấn công có thể truy cập trực tiếp vào tệp mong muốn mà không cần sử dụng chuỗi ../ để di chuyển giữa các thư mục.

# Lab: File path traversal, traversal sequences blocked with absolute path bypass

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image7.png?raw=true)

Truy cập website:

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image8.png?raw=true)

Chọn 1 hình ảnh chi tiết của 1 sản phẩm và Intercept request này trong Burp Suite: 

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image9.png?raw=true)

Thử thay giá trị tham số filename thành /../../../etc/passwd: 

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image10.png?raw=true)

Có thể website đã lọc các ký tự ../, thử thay thành đường dẫn trực tiếp /etc/passwd: 

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image11.png?raw=true)

=> Đọc được nội dung file /etc/passwd.

Solved the lab!

![img](https://github.com/DucThinh47/PortSwigger/blob/main/Path-Traversal/images/image12.png?raw=true)

# Common obstacles to exploiting path traversal vulnerabilities - Continued

Kẻ tấn công có thể lợi dụng các chuỗi path traversal lồng nhau, chẳng hạn như:

    ....// hoặc ....\/

Nếu ứng dụng chỉ loại bỏ chuỗi ../ nhưng không xử lý đúng cách các chuỗi mở rộng này, chúng có thể tự động rút gọn thành chuỗi path traversal hợp lệ, giúp kẻ tấn công vượt qua cơ chế bảo vệ.

# Lab: File path traversal, traversal sequences stripped non-recursively

![img](13)

Truy cập website: 

![img](14)

Chọn xem chi tiết một hình ảnh của 1 sản phẩm và Intercept request này trong Burp Suite: 

![img](15)

Thử thay giá trị tham số filename thành /../../../etc/passwd: 

![img](16)

Không xem được, có thể website đã lọc ký tự ../, thử giá trị /etc/passwd: 

![img](17)

Cũng không được, thử giá trị ....//....//....//etc/passwd:

![img](18)

Solved the lab!

![img](19)




